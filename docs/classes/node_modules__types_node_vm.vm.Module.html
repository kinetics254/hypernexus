<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>Module | Documentation</title><meta name="description" content="Documentation for Documentation"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">Documentation</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../index.html">Documentation</a></li><li><a href="../modules/node_modules__types_node_vm.html">node_modules/@types/node/vm</a></li><li><a href="../modules/node_modules__types_node_vm.vm.html">vm</a></li><li><a href="node_modules__types_node_vm.vm.Module.html">Module</a></li></ul><h1>Class Module<code class="tsd-tag">Experimental</code></h1></div><section class="tsd-panel tsd-comment"><div class="tsd-comment tsd-typography"><p>This feature is only available with the <code>--experimental-vm-modules</code> command
flag enabled.</p>
<p>The <code>vm.Module</code> class provides a low-level interface for using
ECMAScript modules in VM contexts. It is the counterpart of the <code>vm.Script</code> class that closely mirrors <a href="https://262.ecma-international.org/14.0/#sec-abstract-module-records">Module Record</a> s as
defined in the ECMAScript
specification.</p>
<p>Unlike <code>vm.Script</code> however, every <code>vm.Module</code> object is bound to a context from
its creation. Operations on <code>vm.Module</code> objects are intrinsically asynchronous,
in contrast with the synchronous nature of <code>vm.Script</code> objects. The use of
'async' functions can help with manipulating <code>vm.Module</code> objects.</p>
<p>Using a <code>vm.Module</code> object requires three distinct steps: creation/parsing,
linking, and evaluation. These three steps are illustrated in the following
example.</p>
<p>This implementation lies at a lower level than the <code>ECMAScript Module loader</code>. There is also no way to interact with the Loader yet, though
support is planned.</p>
<pre><code class="js"><span class="hl-1">import</span><span class="hl-2"> </span><span class="hl-3">vm</span><span class="hl-2"> </span><span class="hl-1">from</span><span class="hl-2"> </span><span class="hl-4">&#39;node:vm&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-0">const</span><span class="hl-2"> </span><span class="hl-5">contextifiedObject</span><span class="hl-2"> = </span><span class="hl-3">vm</span><span class="hl-2">.</span><span class="hl-7">createContext</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-3">secret:</span><span class="hl-2"> </span><span class="hl-9">42</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-3">print:</span><span class="hl-2"> </span><span class="hl-3">console</span><span class="hl-2">.</span><span class="hl-3">log</span><span class="hl-2">,</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-6">// Step 1</span><br/><span class="hl-6">//</span><br/><span class="hl-6">// Create a Module by constructing a new `vm.SourceTextModule` object. This</span><br/><span class="hl-6">// parses the provided source text, throwing a `SyntaxError` if anything goes</span><br/><span class="hl-6">// wrong. By default, a Module is created in the top context. But here, we</span><br/><span class="hl-6">// specify `contextifiedObject` as the context this Module belongs to.</span><br/><span class="hl-6">//</span><br/><span class="hl-6">// Here, we attempt to obtain the default export from the module &quot;foo&quot;, and</span><br/><span class="hl-6">// put it into local binding &quot;secret&quot;.</span><br/><br/><span class="hl-0">const</span><span class="hl-2"> </span><span class="hl-5">bar</span><span class="hl-2"> = </span><span class="hl-0">new</span><span class="hl-2"> </span><span class="hl-3">vm</span><span class="hl-2">.</span><span class="hl-7">SourceTextModule</span><span class="hl-2">(</span><span class="hl-4">`</span><br/><span class="hl-4">  import s from &#39;foo&#39;;</span><br/><span class="hl-4">  s;</span><br/><span class="hl-4">  print(s);</span><br/><span class="hl-4">`</span><span class="hl-2">, { </span><span class="hl-3">context:</span><span class="hl-2"> </span><span class="hl-3">contextifiedObject</span><span class="hl-2"> });</span><br/><br/><span class="hl-6">// Step 2</span><br/><span class="hl-6">//</span><br/><span class="hl-6">// &quot;Link&quot; the imported dependencies of this Module to it.</span><br/><span class="hl-6">//</span><br/><span class="hl-6">// The provided linking callback (the &quot;linker&quot;) accepts two arguments: the</span><br/><span class="hl-6">// parent module (`bar` in this case) and the string that is the specifier of</span><br/><span class="hl-6">// the imported module. The callback is expected to return a Module that</span><br/><span class="hl-6">// corresponds to the provided specifier, with certain requirements documented</span><br/><span class="hl-6">// in `module.link()`.</span><br/><span class="hl-6">//</span><br/><span class="hl-6">// If linking has not started for the returned Module, the same linker</span><br/><span class="hl-6">// callback will be called on the returned Module.</span><br/><span class="hl-6">//</span><br/><span class="hl-6">// Even top-level Modules without dependencies must be explicitly linked. The</span><br/><span class="hl-6">// callback provided would never be called, however.</span><br/><span class="hl-6">//</span><br/><span class="hl-6">// The link() method returns a Promise that will be resolved when all the</span><br/><span class="hl-6">// Promises returned by the linker resolve.</span><br/><span class="hl-6">//</span><br/><span class="hl-6">// Note: This is a contrived example in that the linker function creates a new</span><br/><span class="hl-6">// &quot;foo&quot; module every time it is called. In a full-fledged module system, a</span><br/><span class="hl-6">// cache would probably be used to avoid duplicated modules.</span><br/><br/><span class="hl-0">async</span><span class="hl-2"> </span><span class="hl-0">function</span><span class="hl-2"> </span><span class="hl-7">linker</span><span class="hl-2">(</span><span class="hl-3">specifier</span><span class="hl-2">, </span><span class="hl-3">referencingModule</span><span class="hl-2">) {</span><br/><span class="hl-2">  </span><span class="hl-1">if</span><span class="hl-2"> (</span><span class="hl-3">specifier</span><span class="hl-2"> === </span><span class="hl-4">&#39;foo&#39;</span><span class="hl-2">) {</span><br/><span class="hl-2">    </span><span class="hl-1">return</span><span class="hl-2"> </span><span class="hl-0">new</span><span class="hl-2"> </span><span class="hl-3">vm</span><span class="hl-2">.</span><span class="hl-7">SourceTextModule</span><span class="hl-2">(</span><span class="hl-4">`</span><br/><span class="hl-4">      // The &quot;secret&quot; variable refers to the global variable we added to</span><br/><span class="hl-4">      // &quot;contextifiedObject&quot; when creating the context.</span><br/><span class="hl-4">      export default secret;</span><br/><span class="hl-4">    `</span><span class="hl-2">, { </span><span class="hl-3">context:</span><span class="hl-2"> </span><span class="hl-3">referencingModule</span><span class="hl-2">.</span><span class="hl-3">context</span><span class="hl-2"> });</span><br/><br/><span class="hl-2">    </span><span class="hl-6">// Using `contextifiedObject` instead of `referencingModule.context`</span><br/><span class="hl-2">    </span><span class="hl-6">// here would work as well.</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">  </span><span class="hl-1">throw</span><span class="hl-2"> </span><span class="hl-0">new</span><span class="hl-2"> </span><span class="hl-7">Error</span><span class="hl-2">(</span><span class="hl-4">`Unable to resolve dependency: </span><span class="hl-0">${</span><span class="hl-3">specifier</span><span class="hl-0">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">}</span><br/><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-3">bar</span><span class="hl-2">.</span><span class="hl-7">link</span><span class="hl-2">(</span><span class="hl-3">linker</span><span class="hl-2">);</span><br/><br/><span class="hl-6">// Step 3</span><br/><span class="hl-6">//</span><br/><span class="hl-6">// Evaluate the Module. The evaluate() method returns a promise which will</span><br/><span class="hl-6">// resolve after the module has finished evaluating.</span><br/><br/><span class="hl-6">// Prints 42.</span><br/><span class="hl-1">await</span><span class="hl-2"> </span><span class="hl-3">bar</span><span class="hl-2">.</span><span class="hl-7">evaluate</span><span class="hl-2">();</span>
</code><button type="button">Copy</button></pre>

</div><div class="tsd-comment tsd-typography"><div class="tsd-tag-since"><h4 class="tsd-anchor-link"><a id="since" class="tsd-anchor"></a>Since<a href="#since" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>v13.0.0, v12.16.0</p>
</div></div></section><section class="tsd-panel tsd-hierarchy" data-refl="53631"><h4>Hierarchy (<a href="../hierarchy.html#node_modules/@types/node/vm.vm.Module">View Summary</a>)</h4><ul class="tsd-hierarchy"><li class="tsd-hierarchy-item"><span class="tsd-hierarchy-target">Module</span><ul class="tsd-hierarchy"><li class="tsd-hierarchy-item"><a href="node_modules__types_node_vm.vm.SourceTextModule.html" class="tsd-signature-type tsd-kind-class">SourceTextModule</a></li><li class="tsd-hierarchy-item"><a href="node_modules__types_node_vm.vm.SyntheticModule.html" class="tsd-signature-type tsd-kind-class">SyntheticModule</a></li></ul></li></ul></section><aside class="tsd-sources"><ul><li>Defined in node_modules/@types/node/vm.d.ts:742</li></ul></aside><section class="tsd-panel-group tsd-index-group"><section class="tsd-panel tsd-index-panel"><details class="tsd-index-content tsd-accordion" open><summary class="tsd-accordion-summary tsd-index-summary"><h5 class="tsd-index-heading uppercase" role="button" aria-expanded="false" tabIndex="0"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronSmall"></use></svg> Index</h5></summary><div class="tsd-accordion-details"><section class="tsd-index-section"><h3 class="tsd-index-heading">Constructors</h3><div class="tsd-index-list"><a href="node_modules__types_node_vm.vm.Module.html#constructor" class="tsd-index-link tsd-is-external"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Constructor"><use href="../assets/icons.svg#icon-512"></use></svg><span>constructor</span></a>
</div></section><section class="tsd-index-section"><h3 class="tsd-index-heading">Properties</h3><div class="tsd-index-list"><a href="node_modules__types_node_vm.vm.Module.html#context" class="tsd-index-link tsd-is-external"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Property"><use href="../assets/icons.svg#icon-1024"></use></svg><span>context</span></a>
<a href="node_modules__types_node_vm.vm.Module.html#dependencyspecifiers" class="tsd-index-link tsd-is-external"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Property"><use href="../assets/icons.svg#icon-1024"></use></svg><span>dependency<wbr/>Specifiers</span></a>
<a href="node_modules__types_node_vm.vm.Module.html#error" class="tsd-index-link tsd-is-external"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Property"><use href="../assets/icons.svg#icon-1024"></use></svg><span>error</span></a>
<a href="node_modules__types_node_vm.vm.Module.html#identifier" class="tsd-index-link tsd-is-external"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Property"><use href="../assets/icons.svg#icon-1024"></use></svg><span>identifier</span></a>
<a href="node_modules__types_node_vm.vm.Module.html#namespace" class="tsd-index-link tsd-is-external"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Property"><use href="../assets/icons.svg#icon-1024"></use></svg><span>namespace</span></a>
<a href="node_modules__types_node_vm.vm.Module.html#status" class="tsd-index-link tsd-is-external"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Property"><use href="../assets/icons.svg#icon-1024"></use></svg><span>status</span></a>
</div></section><section class="tsd-index-section"><h3 class="tsd-index-heading">Methods</h3><div class="tsd-index-list"><a href="node_modules__types_node_vm.vm.Module.html#evaluate" class="tsd-index-link tsd-is-external"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>evaluate</span></a>
<a href="node_modules__types_node_vm.vm.Module.html#link" class="tsd-index-link tsd-is-external"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>link</span></a>
</div></section></div></details></section></section><details class="tsd-panel-group tsd-member-group tsd-accordion" open><summary class="tsd-accordion-summary" data-key="section-Constructors"><h2><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg> Constructors</h2></summary><section><section class="tsd-panel tsd-member tsd-is-external"><a id="constructor" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><span>constructor</span><a href="#constructor" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures tsd-is-external"><li class="tsd-is-external"><div class="tsd-signature tsd-anchor-link"><a id="constructormodule" class="tsd-anchor"></a><span class="tsd-signature-keyword">new</span> <span class="tsd-kind-constructor-signature">Module</span><span class="tsd-signature-symbol">()</span><span class="tsd-signature-symbol">:</span> <a href="node_modules__types_node_vm.vm.Module.html" class="tsd-signature-type tsd-kind-class">Module</a><a href="#constructormodule" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></div><div class="tsd-description"><code class="tsd-tag">Experimental</code><h4 class="tsd-returns-title">Returns <a href="node_modules__types_node_vm.vm.Module.html" class="tsd-signature-type tsd-kind-class">Module</a></h4><div class="tsd-comment tsd-typography"></div></div></li></ul></section></section></details><details class="tsd-panel-group tsd-member-group tsd-accordion" open><summary class="tsd-accordion-summary" data-key="section-Properties"><h2><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg> Properties</h2></summary><section><section class="tsd-panel tsd-member tsd-is-external"><a id="context" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><code class="tsd-tag">Experimental</code><span>context</span><a href="#context" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><div class="tsd-signature"><span class="tsd-kind-property">context</span><span class="tsd-signature-symbol">:</span> <a href="../interfaces/node_modules__types_node_vm.vm.Context.html" class="tsd-signature-type tsd-kind-interface">Context</a></div><div class="tsd-comment tsd-typography"></div><aside class="tsd-sources"><ul><li>Defined in node_modules/@types/node/vm.d.ts:767</li></ul></aside></section><section class="tsd-panel tsd-member tsd-is-external"><a id="dependencyspecifiers" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><code class="tsd-tag">Experimental</code><span>dependency<wbr/>Specifiers</span><a href="#dependencyspecifiers" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><div class="tsd-signature"><span class="tsd-kind-property">dependencySpecifiers</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-keyword">readonly</span> <span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">[]</span></div><div class="tsd-comment tsd-typography"><p>The specifiers of all dependencies of this module. The returned array is frozen
to disallow any changes to it.</p>
<p>Corresponds to the <code>[[RequestedModules]]</code> field of <a href="https://tc39.es/ecma262/#sec-cyclic-module-records">Cyclic Module Record</a> s in
the ECMAScript specification.</p>
</div><div class="tsd-comment tsd-typography"></div><aside class="tsd-sources"><ul><li>Defined in node_modules/@types/node/vm.d.ts:750</li></ul></aside></section><section class="tsd-panel tsd-member tsd-is-external"><a id="error" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><code class="tsd-tag">Experimental</code><span>error</span><a href="#error" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><div class="tsd-signature"><span class="tsd-kind-property">error</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">any</span></div><div class="tsd-comment tsd-typography"><p>If the <code>module.status</code> is <code>'errored'</code>, this property contains the exception
thrown by the module during evaluation. If the status is anything else,
accessing this property will result in a thrown exception.</p>
<p>The value <code>undefined</code> cannot be used for cases where there is not a thrown
exception due to possible ambiguity with <code>throw undefined;</code>.</p>
<p>Corresponds to the <code>[[EvaluationError]]</code> field of <a href="https://tc39.es/ecma262/#sec-cyclic-module-records">Cyclic Module Record</a> s
in the ECMAScript specification.</p>
</div><div class="tsd-comment tsd-typography"></div><aside class="tsd-sources"><ul><li>Defined in node_modules/@types/node/vm.d.ts:762</li></ul></aside></section><section class="tsd-panel tsd-member tsd-is-external"><a id="identifier" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><code class="tsd-tag">Experimental</code><span>identifier</span><a href="#identifier" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><div class="tsd-signature"><span class="tsd-kind-property">identifier</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span></div><div class="tsd-comment tsd-typography"><p>The identifier of the current module, as set in the constructor.</p>
</div><div class="tsd-comment tsd-typography"></div><aside class="tsd-sources"><ul><li>Defined in node_modules/@types/node/vm.d.ts:766</li></ul></aside></section><section class="tsd-panel tsd-member tsd-is-external"><a id="namespace" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><code class="tsd-tag">Experimental</code><span>namespace</span><a href="#namespace" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><div class="tsd-signature"><span class="tsd-kind-property">namespace</span><span class="tsd-signature-symbol">:</span> <a href="../interfaces/node_modules_typescript_lib_lib.es5.Object.html" class="tsd-signature-type tsd-kind-interface">Object</a></div><div class="tsd-comment tsd-typography"><p>The namespace object of the module. This is only available after linking
(<code>module.link()</code>) has completed.</p>
<p>Corresponds to the <a href="https://tc39.es/ecma262/#sec-getmodulenamespace">GetModuleNamespace</a> abstract operation in the ECMAScript
specification.</p>
</div><div class="tsd-comment tsd-typography"></div><aside class="tsd-sources"><ul><li>Defined in node_modules/@types/node/vm.d.ts:775</li></ul></aside></section><section class="tsd-panel tsd-member tsd-is-external"><a id="status" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><code class="tsd-tag">Experimental</code><span>status</span><a href="#status" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><div class="tsd-signature"><span class="tsd-kind-property">status</span><span class="tsd-signature-symbol">:</span> <a href="../types/node_modules__types_node_vm.vm.ModuleStatus.html" class="tsd-signature-type tsd-kind-type-alias">ModuleStatus</a></div><div class="tsd-comment tsd-typography"><p>The current status of the module. Will be one of:</p>
<ul>
<li><code>'unlinked'</code>: <code>module.link()</code> has not yet been called.</li>
<li><code>'linking'</code>: <code>module.link()</code> has been called, but not all Promises returned
by the linker function have been resolved yet.</li>
<li><code>'linked'</code>: The module has been linked successfully, and all of its
dependencies are linked, but <code>module.evaluate()</code> has not yet been called.</li>
<li><code>'evaluating'</code>: The module is being evaluated through a <code>module.evaluate()</code> on
itself or a parent module.</li>
<li><code>'evaluated'</code>: The module has been successfully evaluated.</li>
<li><code>'errored'</code>: The module has been evaluated, but an exception was thrown.</li>
</ul>
<p>Other than <code>'errored'</code>, this status string corresponds to the specification's <a href="https://tc39.es/ecma262/#sec-cyclic-module-records">Cyclic Module Record</a>'s <code>[[Status]]</code> field. <code>'errored'</code>
corresponds to <code>'evaluated'</code> in the specification, but with <code>[[EvaluationError]]</code> set to a
value that is not <code>undefined</code>.</p>
</div><div class="tsd-comment tsd-typography"></div><aside class="tsd-sources"><ul><li>Defined in node_modules/@types/node/vm.d.ts:793</li></ul></aside></section></section></details><details class="tsd-panel-group tsd-member-group tsd-accordion" open><summary class="tsd-accordion-summary" data-key="section-Methods"><h2><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg> Methods</h2></summary><section><section class="tsd-panel tsd-member tsd-is-external"><a id="evaluate" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><span>evaluate</span><a href="#evaluate" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures tsd-is-external"><li class="tsd-is-external"><div class="tsd-signature tsd-anchor-link"><a id="evaluate-1" class="tsd-anchor"></a><span class="tsd-kind-call-signature">evaluate</span><span class="tsd-signature-symbol">(</span><span class="tsd-kind-parameter">options</span><span class="tsd-signature-symbol">?:</span> <a href="../interfaces/node_modules__types_node_vm.vm.ModuleEvaluateOptions.html" class="tsd-signature-type tsd-kind-interface">ModuleEvaluateOptions</a><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">:</span> <a href="../interfaces/node_modules_typescript_lib_lib.es2015.iterable.Promise.html" class="tsd-signature-type tsd-kind-interface">Promise</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span><a href="#evaluate-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></div><div class="tsd-description"><code class="tsd-tag">Experimental</code><div class="tsd-comment tsd-typography"><p>Evaluate the module.</p>
<p>This must be called after the module has been linked; otherwise it will reject.
It could be called also when the module has already been evaluated, in which
case it will either do nothing if the initial evaluation ended in success
(<code>module.status</code> is <code>'evaluated'</code>) or it will re-throw the exception that the
initial evaluation resulted in (<code>module.status</code> is <code>'errored'</code>).</p>
<p>This method cannot be called while the module is being evaluated
(<code>module.status</code> is <code>'evaluating'</code>).</p>
<p>Corresponds to the <a href="https://tc39.es/ecma262/#sec-moduleevaluation">Evaluate() concrete method</a> field of <a href="https://tc39.es/ecma262/#sec-cyclic-module-records">Cyclic Module Record</a> s in the
ECMAScript specification.</p>
</div><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><code class="tsd-tag">Optional</code><span class="tsd-kind-parameter">options</span>: <a href="../interfaces/node_modules__types_node_vm.vm.ModuleEvaluateOptions.html" class="tsd-signature-type tsd-kind-interface">ModuleEvaluateOptions</a></span></li></ul></div><h4 class="tsd-returns-title">Returns <a href="../interfaces/node_modules_typescript_lib_lib.es2015.iterable.Promise.html" class="tsd-signature-type tsd-kind-interface">Promise</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></h4><p>Fulfills with <code>undefined</code> upon success.</p>
<div class="tsd-comment tsd-typography"></div><aside class="tsd-sources"><ul><li>Defined in node_modules/@types/node/vm.d.ts:810</li></ul></aside></div></li></ul></section><section class="tsd-panel tsd-member tsd-is-external"><a id="link" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><span>link</span><a href="#link" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures tsd-is-external"><li class="tsd-is-external"><div class="tsd-signature tsd-anchor-link"><a id="link-1" class="tsd-anchor"></a><span class="tsd-kind-call-signature">link</span><span class="tsd-signature-symbol">(</span><span class="tsd-kind-parameter">linker</span><span class="tsd-signature-symbol">:</span> <a href="../types/node_modules__types_node_vm.vm.ModuleLinker.html" class="tsd-signature-type tsd-kind-type-alias">ModuleLinker</a><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">:</span> <a href="../interfaces/node_modules_typescript_lib_lib.es2015.iterable.Promise.html" class="tsd-signature-type tsd-kind-interface">Promise</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span><a href="#link-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></div><div class="tsd-description"><code class="tsd-tag">Experimental</code><div class="tsd-comment tsd-typography"><p>Link module dependencies. This method must be called before evaluation, and
can only be called once per module.</p>
<p>The function is expected to return a <code>Module</code> object or a <code>Promise</code> that
eventually resolves to a <code>Module</code> object. The returned <code>Module</code> must satisfy the
following two invariants:</p>
<ul>
<li>It must belong to the same context as the parent <code>Module</code>.</li>
<li>Its <code>status</code> must not be <code>'errored'</code>.</li>
</ul>
<p>If the returned <code>Module</code>'s <code>status</code> is <code>'unlinked'</code>, this method will be
recursively called on the returned <code>Module</code> with the same provided <code>linker</code> function.</p>
<p><code>link()</code> returns a <code>Promise</code> that will either get resolved when all linking
instances resolve to a valid <code>Module</code>, or rejected if the linker function either
throws an exception or returns an invalid <code>Module</code>.</p>
<p>The linker function roughly corresponds to the implementation-defined <a href="https://tc39.es/ecma262/#sec-hostresolveimportedmodule">HostResolveImportedModule</a> abstract operation in the
ECMAScript
specification, with a few key differences:</p>
<ul>
<li>The linker function is allowed to be asynchronous while <a href="https://tc39.es/ecma262/#sec-hostresolveimportedmodule">HostResolveImportedModule</a> is synchronous.</li>
</ul>
<p>The actual <a href="https://tc39.es/ecma262/#sec-hostresolveimportedmodule">HostResolveImportedModule</a> implementation used during module
linking is one that returns the modules linked during linking. Since at
that point all modules would have been fully linked already, the <a href="https://tc39.es/ecma262/#sec-hostresolveimportedmodule">HostResolveImportedModule</a> implementation is fully synchronous per
specification.</p>
<p>Corresponds to the <a href="https://tc39.es/ecma262/#sec-moduledeclarationlinking">Link() concrete method</a> field of <a href="https://tc39.es/ecma262/#sec-cyclic-module-records">Cyclic Module Record</a> s in
the ECMAScript specification.</p>
</div><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><span class="tsd-kind-parameter">linker</span>: <a href="../types/node_modules__types_node_vm.vm.ModuleLinker.html" class="tsd-signature-type tsd-kind-type-alias">ModuleLinker</a></span></li></ul></div><h4 class="tsd-returns-title">Returns <a href="../interfaces/node_modules_typescript_lib_lib.es2015.iterable.Promise.html" class="tsd-signature-type tsd-kind-interface">Promise</a><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></h4><div class="tsd-comment tsd-typography"></div><aside class="tsd-sources"><ul><li>Defined in node_modules/@types/node/vm.d.ts:843</li></ul></aside></div></li></ul></section></section></details></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><details open class="tsd-accordion tsd-page-navigation-section"><summary class="tsd-accordion-summary" data-key="section-Constructors"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Constructors</summary><div><a href="#constructor" class="tsd-is-external"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Constructor"><use href="../assets/icons.svg#icon-512"></use></svg><span>constructor</span></a></div></details><details open class="tsd-accordion tsd-page-navigation-section"><summary class="tsd-accordion-summary" data-key="section-Properties"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Properties</summary><div><a href="#context" class="tsd-is-external"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Property"><use href="../assets/icons.svg#icon-1024"></use></svg><span>context</span></a><a href="#dependencyspecifiers" class="tsd-is-external"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Property"><use href="../assets/icons.svg#icon-1024"></use></svg><span>dependency<wbr/>Specifiers</span></a><a href="#error" class="tsd-is-external"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Property"><use href="../assets/icons.svg#icon-1024"></use></svg><span>error</span></a><a href="#identifier" class="tsd-is-external"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Property"><use href="../assets/icons.svg#icon-1024"></use></svg><span>identifier</span></a><a href="#namespace" class="tsd-is-external"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Property"><use href="../assets/icons.svg#icon-1024"></use></svg><span>namespace</span></a><a href="#status" class="tsd-is-external"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Property"><use href="../assets/icons.svg#icon-1024"></use></svg><span>status</span></a></div></details><details open class="tsd-accordion tsd-page-navigation-section"><summary class="tsd-accordion-summary" data-key="section-Methods"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Methods</summary><div><a href="#evaluate" class="tsd-is-external"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>evaluate</span></a><a href="#link" class="tsd-is-external"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>link</span></a></div></details></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../index.html">Documentation</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
